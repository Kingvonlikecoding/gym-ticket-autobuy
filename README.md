# 体育馆预约助手

## 项目简介

体育馆预约助手是一个基于Tkinter的GUI应用，用于自动化预约SZU粤海校区的体育馆场地，包括健身房、羽毛球馆和篮球馆。该应用提供了友好的界面，方便用户配置预约信息并自动执行预约流程。

## 功能特性

- ✅ **账号管理**：支持多账号配置和切换
- ✅ **预约设置**：可配置预约日期、时间段、场馆类型和场地选择
- ✅ **高级选项**：支持显示/隐藏浏览器、设置刷新间隔
- ✅ **余票查询**：可查询当日有票的时间段
- ✅ **日志记录**：详细记录预约过程和错误信息
- ✅ **定时预约**：支持配合Windows任务计划程序实现定时自动预约

## 安装步骤

### 1. 安装Python

确保您已经安装了Python 3.8或更高版本，并将其添加到系统PATH环境变量中。

### 2. 安装依赖

在项目根目录下打开命令提示符，运行以下命令安装依赖：

```bash
pip install -r requirements.txt
```

或者如果使用uv包管理器：

```bash
uv install
```

### 3. 克隆项目

如果您是通过Git获取项目，请运行：

```bash
git clone <项目地址>
cd gym-ticket-autobuy
```

## 使用方法

### 1. 图形界面操作（推荐）

运行`launcher.py`文件，将显示操作界面，您可以在这进行以下操作：

#### 账号设置
- 输入用户名（学号）和密码
- 设置支付密码
- 保存账号信息
- 切换账号（选择不同的配置文件）
- 清除登录状态和日志

#### 预约设置
- 选择预约日期（today/tomorrow）
- 选择时间段（08:00-22:00）
- 选择场馆类型（健身房/羽毛球场/篮球场）
- 对于篮球场，可选择内场/外场
- 高级选项：设置是否显示浏览器、刷新间隔

#### 运行
- 点击"开始运行"执行完整预约流程
- 点击"只登录"仅执行登录操作

### 2. 定时任务设置

使用`for_scheduler.py`配合Windows任务计划程序实现定时自动预约：

1. 打开Windows任务计划程序
2. 创建新任务
3. 设置触发时间（建议每天中午12:30，即放票时间）
4. 设置操作为"启动程序"
5. 选择`for_scheduler.py`文件
6. 配置完成后，任务将在指定时间自动执行

## 项目结构

```
gym-ticket-autobuy/
├── main.py              # 主程序文件，包含GUI界面和主要功能
├── launcher.py          # 应用启动器
├── for_scheduler.py     # 用于定时任务的脚本
├── pages/               # 页面模块
│   ├── __init__.py
│   ├── login_page.py    # 登录页面
│   ├── pay_page.py      # 支付页面
│   └── ticket_page.py   # 票务页面
├── tests/               # 测试文件
│   ├── conftest.py
│   ├── test_account_switch.py
│   ├── test_leftover.py
│   ├── test_login.py
│   └── test_main.py
├── utils/               # 工具模块
│   └── logger.py        # 日志记录工具
├── config/              # 配置文件目录
│   └── settings_*.json  # 用户配置文件（自动生成）
├── .gitignore
├── LICENSE
├── pyproject.toml       # 项目配置文件
├── pytest.ini           # Pytest配置
└── README.md            # 项目说明文档
```

## 注意事项

* ❗❗❗请不要分享settings_*.json文件，此文件包含您的账号密码等重要信息
* 请确保您的校园网络连接稳定
* 没票或未到放票时间时会显示相应提示
* 脚本运行时间长是正常现象，可能是因为正在等待放票
* 目前仅适用于SZU粤海校区的健身房、篮球馆和羽毛球馆
* 如遇错误，请查看logs目录下的日志文件

## 常见问题

### Q: 为什么脚本运行后没有反应？
A: 请检查网络连接是否正常，是否已到放票时间，或查看日志文件了解具体错误信息。

### Q: 如何切换账号？
A: 在"账号设置"标签页中点击"选择配置文件"按钮，选择对应的settings_*.json文件。

### Q: 为什么预约失败？
A: 可能的原因包括：网络不稳定、账号密码错误、所选时间段已无票、系统维护等。请查看日志文件了解具体错误信息。

### Q: 如何查看日志？
A: 日志文件保存在logs目录下，您可以使用文本编辑器打开查看。

## 技术栈

- Python 3.8+
- Tkinter (GUI框架)
- Selenium (自动化浏览器操作)
- Pytest (测试框架)

## 开发说明

如果您想参与项目开发或进行定制修改，请参考以下步骤：

1. 克隆项目到本地
2. 安装开发依赖
3. 运行测试确保代码正常工作
4. 进行开发和修改
5. 提交代码前确保所有测试通过

## 许可证

[MIT License](LICENSE)
